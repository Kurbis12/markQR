<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/registrationStyle.css">
    <title>Leaf Registration</title>
</head>
<body>
    <h1>Leaf Registration Page</h1>
    
    <div class="form-container">
        <form id="registrationForm">
            <div>
                <p id="result">Loading...</p>
            </div>
            <div id="ghOption">
                <select id="greenhouse">
                    <option value="" disabled selected>Select Plant name</option>
                    <option value="plant-name1">GH1L1P24(GH1 Line-1 Plant-24)</option>
                    <option value="plant-name2">GH2L4P20(GH2 Line-4 Plant-20)</option>
                    <option value="plant-name3">GH3L6P17(GH3 Line-6 Plant-17)</option>
                    <option value="plant-name4">GH4L3P12(GH4 Line-3 Plant-12)</option>
                    <option value="plant-name5">GH5L8P8(GH5 Line-8 Plant-8)</option>
                    <option value="plant-name6">GH6L2P10(GH6 Line-2 Plant-10)</option>
                    <option value="plant-name7">GH7L5P5(GH7 Line-5 Plant-5)</option>
                    <option value="plant-name8">GH8L7P15(GH8 Line-7 Plant-15)</option>
                </select>
            </div>
            <div id="lengthName">
                <input id="lengthInput" type="number" placeholder="Length">
            </div>
            <div id="widthName">
                <input id="widthInput" type="number" placeholder="Width">
            </div>
        </form>
        <div class="button-container">
            <button id="Back" onclick="window.history.back();">Back</button>
            <button id="Next" type="button">Next</button>
        </div>
    </div>
    
    <script>
        // Display the QR code data from localStorage
        document.addEventListener('DOMContentLoaded', function() {
            const resultElement = document.getElementById('result');
            const scannedCode = localStorage.getItem('scannedCode');
            resultElement.textContent = scannedCode ? scannedCode : 'No QR code data found.';
        });

        // Handle the Next button click event and store form data in localStorage
        document.getElementById('Next').addEventListener('click', function() {
            const greenhouse = document.getElementById('greenhouse').value;
            const lengthInput = document.getElementById('lengthInput').value;
            const widthInput = document.getElementById('widthInput').value;
            const resultElement = document.getElementById('result').textContent;
            const date = new Date().toISOString();

            if (greenhouse && lengthInput && widthInput && resultElement) {
                const leafData = {
                    code_name: resultElement,
                    greenhouse: greenhouse,
                    length: lengthInput,
                    width: widthInput,
                    date: date
                };

                localStorage.setItem('leafData', JSON.stringify(leafData));
                window.location.href = '../html/confirm.html';
            } else {
                alert('Please fill out all fields');
            }
        });

        // Change dropdown text color
        document.getElementById('greenhouse').addEventListener('change', function() {
            this.style.color = this.value ? 'black' : 'lightgrey';
        });
    </script>
</body>
</html>
